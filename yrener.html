<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Yrener</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
<style>
:root{--bg:#0a0a0a;--surface:#111;--surface2:#1a1a1a;--border:rgba(255,255,255,0.08);--text:#f0f0f0;--muted:#666;--accent:#e63e3e;--accent2:#ff5555;--white:#fff;}
*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--bg);color:var(--text);font-family:'Inter',sans-serif;min-height:100vh;overflow-x:hidden;}
.screen{display:none;min-height:100vh;flex-direction:column;}
.screen.active{display:flex;}
nav{position:fixed;top:0;left:0;right:0;z-index:100;padding:16px 24px;display:flex;align-items:center;justify-content:space-between;background:rgba(10,10,10,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);}
.logo{display:flex;align-items:center;gap:10px;font-family:'Syne',sans-serif;font-weight:800;font-size:22px;color:var(--white);}
.logo-icon{width:36px;height:36px;background:var(--accent);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:900;color:#fff;font-family:'Syne',sans-serif;}
.nav-actions{display:flex;gap:10px;align-items:center;}
.nav-btn{width:42px;height:42px;border-radius:12px;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.2s;background:var(--surface2);color:var(--text);font-size:18px;text-decoration:none;}
.nav-btn.tg{background:#2AABEE;color:#fff;}
.nav-btn:hover{transform:scale(1.08);}
.hero{padding:120px 24px 60px;flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;position:relative;overflow:hidden;}
.hero::before{content:'';position:absolute;top:10%;left:50%;transform:translateX(-50%);width:600px;height:600px;background:radial-gradient(circle,rgba(230,62,62,0.12) 0%,transparent 70%);pointer-events:none;border-radius:50%;animation:pulseGlow 4s ease-in-out infinite;}
@keyframes pulseGlow{0%,100%{opacity:0.6;transform:translateX(-50%) scale(1);}50%{opacity:1;transform:translateX(-50%) scale(1.1);}}
.hero-badge{display:inline-flex;align-items:center;gap:6px;background:rgba(230,62,62,0.15);border:1px solid rgba(230,62,62,0.3);border-radius:100px;padding:6px 14px;font-size:12px;color:var(--accent2);font-weight:500;margin-bottom:28px;animation:fadeUp 0.6s ease both;}
.hero h1{font-family:'Syne',sans-serif;font-size:clamp(42px,10vw,80px);font-weight:800;line-height:1.05;letter-spacing:-2px;color:var(--white);margin-bottom:20px;animation:fadeUp 0.7s ease both;}
.hero h1 span{color:var(--accent);}
.hero>p{font-size:16px;color:var(--muted);max-width:380px;line-height:1.7;margin-bottom:40px;animation:fadeUp 0.8s ease both;}
.glass-card{background:rgba(255,255,255,0.03);backdrop-filter:blur(30px);border:1px solid rgba(255,255,255,0.09);border-radius:24px;padding:32px 28px;width:100%;max-width:360px;box-shadow:0 8px 40px rgba(0,0,0,0.5),inset 0 1px 0 rgba(255,255,255,0.07);animation:fadeUp 0.9s ease both;position:relative;overflow:hidden;}
.glass-card::before{content:'';position:absolute;top:-50%;left:-20%;width:140%;height:100%;background:linear-gradient(135deg,rgba(255,255,255,0.04) 0%,transparent 60%);pointer-events:none;}
.btn{width:100%;padding:16px;border-radius:14px;border:none;cursor:pointer;font-family:'Syne',sans-serif;font-size:16px;font-weight:700;letter-spacing:0.3px;transition:all 0.25s cubic-bezier(0.34,1.56,0.64,1);position:relative;}
.btn-primary{background:var(--accent);color:#fff;box-shadow:0 4px 20px rgba(230,62,62,0.3);}
.btn-primary:hover{transform:translateY(-2px) scale(1.02);box-shadow:0 8px 28px rgba(230,62,62,0.45);}
.btn-secondary{background:var(--surface2);color:var(--text);border:1px solid var(--border);}
.btn-secondary:hover{transform:translateY(-2px);}
.btn-ghost{background:transparent;color:var(--muted);font-size:14px;font-weight:500;}
.btn-ghost:hover{color:var(--text);}
.cta-buttons{display:flex;flex-direction:column;gap:12px;}
.divider{display:flex;align-items:center;gap:12px;margin:4px 0;color:var(--muted);font-size:13px;}
.divider::before,.divider::after{content:'';flex:1;height:1px;background:var(--border);}
.tg-banner{margin:0 20px 24px;background:linear-gradient(135deg,#1a2a3a,#1e3a5f);border:1px solid rgba(42,171,238,0.2);border-radius:20px;padding:20px;display:flex;align-items:center;gap:16px;cursor:pointer;transition:all 0.25s;text-decoration:none;position:relative;overflow:hidden;}
.tg-banner:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(42,171,238,0.2);}
.tg-banner-icon{width:48px;height:48px;background:#2AABEE;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0;}
.tg-banner-text h4{font-family:'Syne',sans-serif;font-weight:700;font-size:15px;color:var(--white);margin-bottom:3px;}
.tg-banner-text p{font-size:12px;color:rgba(255,255,255,0.5);}
.tg-arrow{margin-left:auto;color:rgba(255,255,255,0.3);font-size:20px;}
#authScreen{align-items:center;justify-content:center;padding:24px;position:relative;overflow:hidden;}
#authScreen::before{content:'';position:absolute;top:-20%;left:50%;transform:translateX(-50%);width:500px;height:500px;background:radial-gradient(circle,rgba(230,62,62,0.1) 0%,transparent 70%);pointer-events:none;}
.auth-logo{text-align:center;margin-bottom:32px;}
.big-icon{width:64px;height:64px;background:var(--accent);border-radius:18px;margin:0 auto 14px;display:flex;align-items:center;justify-content:center;font-size:28px;font-weight:900;color:#fff;font-family:'Syne',sans-serif;box-shadow:0 0 0 8px rgba(230,62,62,0.1);}
.auth-logo h1{font-family:'Syne',sans-serif;font-size:32px;font-weight:800;color:var(--white);}
.auth-logo p{color:var(--muted);font-size:14px;margin-top:6px;}
.auth-card{width:100%;max-width:360px;}
.input-group{margin-bottom:14px;}
.input-group label{display:block;font-size:13px;color:var(--muted);margin-bottom:7px;font-weight:500;}
.input-group input{width:100%;padding:14px 16px;background:var(--surface);border:1px solid var(--border);border-radius:12px;color:var(--text);font-size:15px;font-family:'Inter',sans-serif;outline:none;transition:border-color 0.2s,box-shadow 0.2s;}
.input-group input:focus{border-color:rgba(230,62,62,0.5);}
.input-group input::placeholder{color:var(--muted);}
.input-group input.invalid{border-color:rgba(230,62,62,0.6)!important;box-shadow:0 0 0 3px rgba(230,62,62,0.1);}
.input-group input.valid{border-color:rgba(50,200,100,0.5)!important;box-shadow:0 0 0 3px rgba(50,200,100,0.08);}
.field-error{font-size:12px;color:var(--accent2);margin-top:6px;display:none;}
.field-error.show{display:block;animation:fadeUp 0.2s ease;}
.field-hint{font-size:12px;color:var(--muted);margin-top:5px;}
.pwd-strength{margin-top:8px;display:flex;gap:4px;}
.pwd-bar{flex:1;height:3px;border-radius:10px;background:var(--border);transition:background 0.3s;}
.menu-hero{padding:28px 24px 16px;text-align:center;}
.menu-hero h2{font-family:'Syne',sans-serif;font-size:26px;font-weight:800;color:var(--white);margin-bottom:4px;}
.menu-hero p{color:var(--muted);font-size:14px;}
.menu-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;padding:8px 20px 20px;}
.menu-item{background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:22px 18px;cursor:pointer;transition:all 0.25s cubic-bezier(0.34,1.56,0.64,1);position:relative;overflow:hidden;animation:fadeUp 0.5s ease both;}
.menu-item:hover,.menu-item:active{transform:scale(1.04);border-color:rgba(230,62,62,0.3);background:var(--surface2);}
.menu-item::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--accent),transparent);opacity:0;transition:opacity 0.2s;}
.menu-item:hover::before{opacity:1;}
.item-icon{font-size:28px;margin-bottom:10px;display:block;}
.item-title{font-family:'Syne',sans-serif;font-weight:700;font-size:15px;color:var(--white);margin-bottom:4px;}
.item-sub{font-size:12px;color:var(--muted);}
.item-badge{position:absolute;top:12px;right:12px;background:var(--accent);color:#fff;font-size:10px;font-weight:700;padding:2px 7px;border-radius:100px;font-family:'Syne',sans-serif;}
.bottom-nav{position:fixed;bottom:0;left:0;right:0;background:rgba(10,10,10,0.9);backdrop-filter:blur(20px);border-top:1px solid var(--border);display:flex;padding:12px 0 20px;z-index:100;}
.nav-tab{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;cursor:pointer;transition:all 0.2s;padding:4px;}
.nav-tab-icon{font-size:22px;transition:transform 0.2s;}
.nav-tab-label{font-size:11px;color:var(--muted);font-weight:500;transition:color 0.2s;}
.nav-tab.active .nav-tab-label{color:var(--accent);}
.nav-tab.active .nav-tab-icon{transform:scale(1.15);}
.scroll-content{overflow-y:auto;flex:1;padding-bottom:80px;}
.scroll-content::-webkit-scrollbar{display:none;}
.profile-header{padding:32px 24px 20px;text-align:center;}
.avatar{width:80px;height:80px;background:linear-gradient(135deg,var(--accent),#ff8c00);border-radius:50%;margin:0 auto 14px;display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-size:32px;font-weight:800;color:#fff;box-shadow:0 0 0 4px rgba(230,62,62,0.2);}
.profile-name{font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:var(--white);margin-bottom:4px;}
.profile-tag{font-size:13px;color:var(--muted);}
.settings-section{padding:8px 20px;}
.settings-label{font-size:11px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:1px;padding:0 4px;margin-bottom:10px;}
.settings-group{background:var(--surface);border:1px solid var(--border);border-radius:18px;overflow:hidden;margin-bottom:20px;}
.settings-row{display:flex;align-items:center;padding:16px 18px;gap:14px;border-bottom:1px solid var(--border);cursor:pointer;transition:background 0.15s;}
.settings-row:last-child{border-bottom:none;}
.settings-row:hover{background:var(--surface2);}
.srow-icon{width:34px;height:34px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0;}
.srow-text{flex:1;}
.srow-title{font-size:15px;font-weight:500;color:var(--text);}
.srow-sub{font-size:12px;color:var(--muted);margin-top:2px;}
.srow-right{color:var(--muted);font-size:14px;}
.lang-btn{padding:8px 14px;border-radius:10px;border:1px solid var(--border);background:var(--surface2);color:var(--text);font-size:13px;font-weight:500;cursor:pointer;transition:all 0.2s;}
.lang-btn.active{background:var(--accent);border-color:var(--accent);color:#fff;}
.logout-btn{margin:0 20px 32px;width:calc(100% - 40px);padding:16px;border-radius:16px;border:1px solid rgba(230,62,62,0.3);background:rgba(230,62,62,0.08);color:var(--accent2);font-family:'Syne',sans-serif;font-size:16px;font-weight:700;cursor:pointer;transition:all 0.2s;}
.logout-btn:hover{background:rgba(230,62,62,0.15);}
.modal-overlay{display:none;position:fixed;inset:0;z-index:999;background:rgba(0,0,0,0.75);backdrop-filter:blur(6px);align-items:flex-end;justify-content:center;}
.modal-overlay.center{align-items:center;padding:24px;}
.modal-sheet{background:#111;border:1px solid rgba(255,255,255,0.1);border-radius:28px 28px 0 0;padding:28px 24px 44px;width:100%;max-width:480px;animation:slideUp 0.35s cubic-bezier(0.34,1.2,0.64,1) both;}
.modal-center{background:#111;border:1px solid rgba(255,255,255,0.1);border-radius:24px;padding:32px 24px;width:100%;max-width:360px;text-align:center;animation:fadeUp 0.3s ease both;}
.modal-handle{width:40px;height:4px;background:rgba(255,255,255,0.15);border-radius:10px;margin:0 auto 24px;}
.modal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;}
.modal-title{font-family:'Syne',sans-serif;font-size:20px;font-weight:800;color:#fff;}
.modal-close{background:rgba(255,255,255,0.08);border:none;color:#aaa;font-size:20px;width:34px;height:34px;border-radius:10px;cursor:pointer;}
.btn-google{background:#fff;color:#1f1f1f;border:1px solid #e0e0e0;display:flex;align-items:center;justify-content:center;gap:10px;font-family:'Inter',sans-serif;font-weight:600;font-size:15px;}
.btn-google:hover{background:#f8f8f8;transform:translateY(-2px);box-shadow:0 4px 16px rgba(0,0,0,0.15);}
@keyframes fadeUp{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
@keyframes slideUp{from{transform:translateY(100%);opacity:0;}to{transform:translateY(0);opacity:1;}}
.fade-up{animation:fadeUp 0.5s ease both;}
@keyframes shake{0%,100%{transform:translateX(0);}20%{transform:translateX(-8px);}40%{transform:translateX(8px);}60%{transform:translateX(-5px);}80%{transform:translateX(5px);}}
</style>
</head>
<body>

<!-- LANDING -->
<div id="landingScreen" class="screen active">
  <nav>
    <div class="logo"><div class="logo-icon">Y</div>Yrener</div>
    <div class="nav-actions">
      <a href="https://t.me/Yrener_Soft" target="_blank" class="nav-btn tg">‚úà</a>
      <button class="nav-btn" onclick="showAuth('login')">üë§</button>
    </div>
  </nav>
  <div class="hero">
    <div class="hero-badge">‚ö° –ú–µ–Ω—é –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è</div>
    <h1>–î–æ–±—Ä–æ<br>–ø–æ–∂–∞–ª–æ–≤–∞—Ç—å<br>–≤ <span>Yrener</span></h1>
    <p>–ú–æ—â–Ω—ã–π –∏ —Å—Ç–∏–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç. –ë—ã—Å—Ç—Ä–æ. –ö—Ä–∞—Å–∏–≤–æ. –ë–µ–∑ –ª–∏—à–Ω–µ–≥–æ.</p>
    <div class="glass-card">
      <div class="cta-buttons">
        <button class="btn btn-primary" onclick="showAuth('register')">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        <div class="divider">–∏–ª–∏</div>
        <button class="btn btn-google" onclick="signInWithGoogle()">
          <svg width="18" height="18" viewBox="0 0 48 48" style="flex-shrink:0;"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.18 1.48-4.97 2.31-8.16 2.31-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/><path fill="none" d="M0 0h48v48H0z"/></svg>
          –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google
        </button>
        <div class="divider">–∏–ª–∏</div>
        <button class="btn btn-secondary" onclick="showAuth('login')">–í–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç</button>
        <button class="btn btn-ghost" onclick="guestEnter()">–ü–æ–∑–∂–µ ¬∑ –í–æ–π—Ç–∏ –∫–∞–∫ –≥–æ—Å—Ç—å</button>
      </div>
    </div>
  </div>
  <a href="https://t.me/Yrener_Soft" target="_blank" class="tg-banner" style="margin:0 20px 40px;">
    <div class="tg-banner-icon">‚úà</div>
    <div class="tg-banner-text"><h4>–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ Telegram</h4><p>–ù–æ–≤–æ—Å—Ç–∏, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –ø–æ–¥–¥–µ—Ä–∂–∫–∞</p></div>
    <div class="tg-arrow">‚Ä∫</div>
  </a>
</div>

<!-- AUTH -->
<div id="authScreen" class="screen">
  <div class="auth-logo">
    <div class="big-icon">Y</div>
    <h1>Yrener</h1>
    <p id="authSubtitle">–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç</p>
  </div>
  <div class="auth-card glass-card">
    <!-- REGISTER -->
    <div id="registerFields">
      <div class="input-group">
        <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
        <input type="text" id="regUsername" placeholder="yrener123" autocomplete="off" oninput="liveUser(this)">
        <div class="field-error" id="errUsername"></div>
        <div class="field-hint">–¢–æ–ª—å–∫–æ –±—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã</div>
      </div>
      <div class="input-group">
        <label>Email</label>
        <input type="email" id="regEmail" placeholder="your@example.com" autocomplete="off" oninput="liveEmail(this,'errEmail')">
        <div class="field-error" id="errEmail"></div>
      </div>
      <div class="input-group" style="margin-bottom:20px;">
        <label>–ü–∞—Ä–æ–ª—å</label>
        <div style="position:relative;">
          <input type="password" id="regPassword" placeholder="–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤" style="padding-right:48px;" oninput="livePwd(this,'errRegPwd','pwdStr1')">
          <button type="button" onclick="tglPwd('regPassword',this)" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--muted);font-size:18px;">üëÅ</button>
        </div>
        <div class="field-error" id="errRegPwd"></div>
        <div class="pwd-strength" id="pwdStr1"></div>
      </div>
      <button class="btn btn-primary" onclick="doRegister()" style="margin-bottom:10px;">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
      <button class="btn btn-google" onclick="signInWithGoogle()" style="margin-bottom:10px;">
        <svg width="18" height="18" viewBox="0 0 48 48" style="flex-shrink:0;"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.18 1.48-4.97 2.31-8.16 2.31-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/><path fill="none" d="M0 0h48v48H0z"/></svg>
        –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Google
      </button>
      <button class="btn btn-ghost" onclick="showAuth('login')">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏</button>
    </div>
    <!-- LOGIN -->
    <div id="loginFields" style="display:none;">
      <div class="input-group">
        <label>Email</label>
        <input type="email" id="loginEmail" placeholder="your@example.com" autocomplete="off" oninput="liveEmail(this,'errLoginEmail')">
        <div class="field-error" id="errLoginEmail"></div>
      </div>
      <div class="input-group" style="margin-bottom:6px;">
        <label>–ü–∞—Ä–æ–ª—å</label>
        <div style="position:relative;">
          <input type="password" id="loginPass" placeholder="–í–∞—à –ø–∞—Ä–æ–ª—å" style="padding-right:48px;" oninput="clrErr('errLoginPass',this)">
          <button type="button" onclick="tglPwd('loginPass',this)" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--muted);font-size:18px;">üëÅ</button>
        </div>
        <div class="field-error" id="errLoginPass"></div>
      </div>
      <div style="text-align:right;margin-bottom:20px;">
        <button class="btn btn-ghost" onclick="openModal('forgotModal')" style="font-size:13px;width:auto;padding:4px 0;color:var(--accent);">–ó–∞–±—ã–ª –ø–∞—Ä–æ–ª—å?</button>
      </div>
      <button class="btn btn-primary" onclick="doLogin()" style="margin-bottom:10px;">–í–æ–π—Ç–∏</button>
      <button class="btn btn-google" onclick="signInWithGoogle()" style="margin-bottom:10px;">
        <svg width="18" height="18" viewBox="0 0 48 48" style="flex-shrink:0;"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.18 1.48-4.97 2.31-8.16 2.31-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/><path fill="none" d="M0 0h48v48H0z"/></svg>
        –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google
      </button>
      <button class="btn btn-ghost" onclick="showAuth('register')">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
    </div>
    <button class="btn btn-ghost" onclick="showScreen('landingScreen')" style="margin-top:10px;font-size:13px;">‚Üê –ù–∞–∑–∞–¥</button>
  </div>
</div>

<!-- MENU -->
<div id="menuScreen" class="screen" style="padding-top:80px;">
  <nav>
    <div class="logo"><div class="logo-icon">Y</div>Yrener</div>
    <div class="nav-actions">
      <a href="https://t.me/Yrener_Soft" target="_blank" class="nav-btn tg">‚úà</a>
      <button class="nav-btn" onclick="showTab('profile')">üë§</button>
    </div>
  </nav>
  <div class="scroll-content">
    <div class="menu-hero fade-up"><h2 id="greetingText">–ü—Ä–∏–≤–µ—Ç üëã</h2><p>–í—ã–±–µ—Ä–∏ —Ä–∞–∑–¥–µ–ª</p></div>
    <div class="menu-grid">
      <div class="menu-item" onclick="showScreen('downloadScreen')"><span class="item-icon">‚¨áÔ∏è</span><div class="item-title">–°–∫–∞—á–∞—Ç—å</div><div class="item-sub">–ü–æ–ª—É—á–∏—Ç—å —Ñ–∞–π–ª</div><span class="item-badge">NEW</span></div>
      <div class="menu-item" onclick="showScreen('toolsScreen')"><span class="item-icon">üéØ</span><div class="item-title">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</div><div class="item-sub">–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏</div></div>
      <div class="menu-item" onclick="showScreen('protectScreen')"><span class="item-icon">üõ°Ô∏è</span><div class="item-title">–ó–∞—â–∏—Ç–∞</div><div class="item-sub">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</div></div>
      <div class="menu-item" onclick="showScreen('statsScreen')"><span class="item-icon">üìä</span><div class="item-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div><div class="item-sub">–ú–æ—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</div></div>
      <div class="menu-item" style="grid-column:span 2;" onclick="showScreen('supportScreen')"><span class="item-icon">üí¨</span><div class="item-title">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</div><div class="item-sub">–°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏</div></div>
    </div>
    <a href="https://t.me/Yrener_Soft" target="_blank" class="tg-banner"><div class="tg-banner-icon">‚úà</div><div class="tg-banner-text"><h4>–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ Telegram</h4><p>@Yrener_Soft</p></div><div class="tg-arrow">‚Ä∫</div></a>
  </div>
  <div class="bottom-nav">
    <div class="nav-tab active" id="tabM1" onclick="showTab('menu')"><span class="nav-tab-icon">üè†</span><span class="nav-tab-label">–ì–ª–∞–≤–Ω–∞—è</span></div>
    <div class="nav-tab" id="tabP1" onclick="showTab('profile')"><span class="nav-tab-icon">üë§</span><span class="nav-tab-label">–ü—Ä–æ—Ñ–∏–ª—å</span></div>
  </div>
</div>

<!-- PROFILE -->
<div id="profileScreen" class="screen" style="padding-top:80px;">
  <nav><div class="logo"><div class="logo-icon">Y</div>Yrener</div><div class="nav-actions"><a href="https://t.me/Yrener_Soft" target="_blank" class="nav-btn tg">‚úà</a></div></nav>
  <div class="scroll-content">
    <div class="profile-header fade-up">
      <div class="avatar" id="avatarLetter">Y</div>
      <div class="profile-name" id="profileName">–ì–æ—Å—Ç—å</div>
      <div class="profile-tag" id="profileTag">@guest</div>
    </div>
    <div class="settings-section">
      <div class="settings-label">–Ø–∑—ã–∫ / Language</div>
      <div class="settings-group">
        <div class="settings-row" style="cursor:default;flex-wrap:wrap;">
          <div style="display:flex;flex-wrap:wrap;gap:8px;width:100%;">
            <button class="lang-btn active" onclick="setLang(this,'ru')">üá∑üá∫ –†—É—Å—Å–∫–∏–π</button>
            <button class="lang-btn" onclick="setLang(this,'en')">üá¨üáß English</button>
            <button class="lang-btn" onclick="setLang(this,'uz')">üá∫üáø O'zbek</button>
            <button class="lang-btn" onclick="setLang(this,'uk')">üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</button>
            <button class="lang-btn" onclick="setLang(this,'zh')">üá®üá≥ ‰∏≠Êñá</button>
          </div>
        </div>
      </div>
    </div>
    <div class="settings-section">
      <div class="settings-label">–ê–∫–∫–∞—É–Ω—Ç</div>
      <div class="settings-group">
        <div class="settings-row" onclick="openChangePwd()">
          <div class="srow-icon" style="background:rgba(255,160,0,0.15);">üîë</div>
          <div class="srow-text"><div class="srow-title">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</div><div class="srow-sub">–°—Ç–∞—Ä—ã–π –∏ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</div></div>
          <div class="srow-right">‚Ä∫</div>
        </div>
        <div class="settings-row" style="cursor:default;">
          <div class="srow-icon" style="background:rgba(42,171,238,0.15);">üìß</div>
          <div class="srow-text"><div class="srow-title">Email</div><div class="srow-sub" id="profileEmail">‚Äî</div></div>
        </div>
        <div class="settings-row" style="cursor:default;">
          <div class="srow-icon" style="background:rgba(100,200,100,0.15);">üìÖ</div>
          <div class="srow-text"><div class="srow-title">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</div><div class="srow-sub" id="profileDate">‚Äî</div></div>
        </div>
      </div>
    </div>
    <div class="settings-section">
      <div class="settings-label">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</div>
      <div class="settings-group">
        <a href="https://t.me/Yrener_Soft" target="_blank" class="settings-row" style="text-decoration:none;">
          <div class="srow-icon" style="background:rgba(42,171,238,0.15);">‚úà</div>
          <div class="srow-text"><div class="srow-title">Telegram</div><div class="srow-sub">@Yrener_Soft</div></div>
          <div class="srow-right">‚Ä∫</div>
        </a>
        <div class="settings-row" style="cursor:default;">
          <div class="srow-icon" style="background:rgba(255,200,0,0.15);">‚≠ê</div>
          <div class="srow-text"><div class="srow-title">–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</div><div class="srow-sub">v1.0.0</div></div>
        </div>
      </div>
    </div>
    <a href="https://t.me/Yrener_Soft" target="_blank" class="tg-banner" style="margin:0 20px 20px;"><div class="tg-banner-icon">‚úà</div><div class="tg-banner-text"><h4>–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ Telegram</h4><p>@Yrener_Soft</p></div><div class="tg-arrow">‚Ä∫</div></a>
    <button class="logout-btn" onclick="logout()">–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</button>
  </div>
  <div class="bottom-nav">
    <div class="nav-tab" id="tabM2" onclick="showTab('menu')"><span class="nav-tab-icon">üè†</span><span class="nav-tab-label">–ì–ª–∞–≤–Ω–∞—è</span></div>
    <div class="nav-tab active" id="tabP2" onclick="showTab('profile')"><span class="nav-tab-icon">üë§</span><span class="nav-tab-label">–ü—Ä–æ—Ñ–∏–ª—å</span></div>
  </div>
</div>

<!-- SUPPORT -->
<div id="supportScreen" class="screen" style="padding-top:80px;">
  <nav><div class="logo"><div class="logo-icon">Y</div>Yrener</div><div class="nav-actions"><button class="nav-btn" onclick="showTab('menu')" style="width:auto;padding:0 14px;font-family:'Syne',sans-serif;font-size:14px;font-weight:700;">‚Üê –ù–∞–∑–∞–¥</button></div></nav>
  <div class="scroll-content" style="padding:24px 20px 100px;">
    <h2 style="font-family:'Syne',sans-serif;font-size:26px;font-weight:800;color:var(--white);margin-bottom:6px;">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ üí¨</h2>
    <p style="color:var(--muted);font-size:14px;margin-bottom:24px;">–ú—ã –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å–≤—è–∑–∏</p>
    <div style="background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:20px;margin-bottom:20px;min-height:160px;display:flex;flex-direction:column;gap:12px;">
      <div style="display:flex;gap:10px;">
        <div style="width:34px;height:34px;background:var(--accent);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:800;color:#fff;font-family:'Syne',sans-serif;flex-shrink:0;">Y</div>
        <div style="background:var(--surface2);border:1px solid var(--border);border-radius:16px 16px 16px 4px;padding:12px 16px;max-width:85%;">
          <p style="font-size:14px;line-height:1.6;color:var(--text);">–ß–∞—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ <span style="color:var(--accent);font-weight:600;">–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</span> üöß<br>–ù–∞–ø–∏—à–∏ –Ω–∞–º –≤ Telegram ‚Äî –æ—Ç–≤–µ—Ç–∏–º –±—ã—Å—Ç—Ä–æ!</p>
        </div>
      </div>
    </div>
    <div style="display:flex;gap:10px;margin-bottom:20px;opacity:0.4;"><div style="flex:1;background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:14px 16px;color:var(--muted);font-size:14px;">–ß–∞—Ç –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</div><div style="width:48px;height:48px;background:var(--surface2);border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:20px;">‚úà</div></div>
    <a href="https://t.me/Yrener_Soft" target="_blank" class="tg-banner" style="margin:0;"><div class="tg-banner-icon">‚úà</div><div class="tg-banner-text"><h4>–ù–∞–ø–∏—Å–∞—Ç—å –≤ Telegram</h4><p>@Yrener_Soft ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7</p></div><div class="tg-arrow">‚Ä∫</div></a>
  </div>
</div>

<!-- DOWNLOAD -->
<div id="downloadScreen" class="screen" style="padding-top:80px;">
  <nav><div class="logo"><div class="logo-icon">Y</div>Yrener</div><div class="nav-actions"><button class="nav-btn" onclick="showTab('menu')" style="width:auto;padding:0 14px;font-family:'Syne',sans-serif;font-size:14px;font-weight:700;">‚Üê –ù–∞–∑–∞–¥</button></div></nav>
  <div class="scroll-content" style="padding:40px 20px 100px;display:flex;flex-direction:column;align-items:center;text-align:center;">
    <div style="font-size:64px;margin-bottom:20px;">‚¨áÔ∏è</div>
    <h2 style="font-family:'Syne',sans-serif;font-size:28px;font-weight:800;color:var(--white);margin-bottom:10px;">–°–∫–∞—á–∞—Ç—å Yrener</h2>
    <p style="color:var(--muted);font-size:15px;line-height:1.7;max-width:300px;margin-bottom:36px;">–§–∞–π–ª –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –Ω–∞—à–µ–º Telegram –∫–∞–Ω–∞–ª–µ!</p>
    <div class="glass-card">
      <div style="display:flex;align-items:center;gap:14px;margin-bottom:20px;padding-bottom:18px;border-bottom:1px solid var(--border);">
        <div style="width:50px;height:50px;background:rgba(42,171,238,0.15);border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:24px;">üì¶</div>
        <div style="text-align:left;"><div style="font-family:'Syne',sans-serif;font-weight:700;color:var(--white);font-size:15px;">Yrener Menu</div><div style="font-size:12px;color:var(--muted);">–ü–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è ¬∑ –í Telegram</div></div>
      </div>
      <p style="font-size:14px;color:var(--muted);margin-bottom:20px;line-height:1.6;">–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª –≤ –Ω–∞—à–µ–º Telegram –∫–∞–Ω–∞–ª–µ üëá</p>
      <a href="https://t.me/Yrener_Soft" target="_blank" style="text-decoration:none;display:block;"><button class="btn btn-primary" style="display:flex;align-items:center;justify-content:center;gap:10px;width:100%;"><span>‚úà</span><span>–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª –≤ –¢–ì –∫–∞–Ω–∞–ª–µ</span></button></a>
    </div>
  </div>
</div>

<!-- STATS -->
<div id="statsScreen" class="screen" style="padding-top:80px;">
  <nav><div class="logo"><div class="logo-icon">Y</div>Yrener</div><div class="nav-actions"><button class="nav-btn" onclick="showTab('menu')" style="width:auto;padding:0 14px;font-family:'Syne',sans-serif;font-size:14px;font-weight:700;">‚Üê –ù–∞–∑–∞–¥</button></div></nav>
  <div class="scroll-content" style="padding:24px 20px 100px;">
    <h2 style="font-family:'Syne',sans-serif;font-size:26px;font-weight:800;color:var(--white);margin-bottom:6px;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ üìä</h2>
    <p style="color:var(--muted);font-size:14px;margin-bottom:24px;">–¢–≤–æ—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</p>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;">
      <div style="background:var(--surface);border:1px solid var(--border);border-radius:18px;padding:18px;"><div style="font-size:11px;color:var(--muted);font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">–í—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ</div><div id="statTime" style="font-family:'Syne',sans-serif;font-size:24px;font-weight:800;color:var(--white);">0—Å</div><div style="font-size:11px;color:var(--accent);margin-top:4px;">‚ñ≤ –û–Ω–ª–∞–π–Ω</div></div>
      <div style="background:var(--surface);border:1px solid var(--border);border-radius:18px;padding:18px;"><div style="font-size:11px;color:var(--muted);font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">–†–∞–∑–¥–µ–ª–æ–≤ –æ—Ç–∫—Ä—ã—Ç–æ</div><div id="statSections" style="font-family:'Syne',sans-serif;font-size:24px;font-weight:800;color:var(--white);">0</div><div style="font-size:11px;color:var(--muted);margin-top:4px;">–∏–∑ 5 —Ä–∞–∑–¥–µ–ª–æ–≤</div></div>
    </div>
    <div style="background:var(--surface);border:1px solid var(--border);border-radius:18px;padding:18px;margin-bottom:16px;"><div style="font-size:11px;color:var(--muted);font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:14px;">–ò—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤</div><div id="statHistory"><div style="color:var(--muted);font-size:13px;">–ü–æ–∫–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö...</div></div></div>
    <div style="background:var(--surface);border:1px solid var(--border);border-radius:18px;padding:18px;">
      <div style="font-size:11px;color:var(--muted);font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:14px;">–°–µ—Å—Å–∏—è</div>
      <div style="display:flex;flex-direction:column;gap:10px;">
        <div style="display:flex;justify-content:space-between;"><span style="font-size:14px;color:var(--muted);">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span><span id="statUser" style="font-size:14px;font-weight:600;color:var(--white);">‚Äî</span></div>
        <div style="display:flex;justify-content:space-between;"><span style="font-size:14px;color:var(--muted);">–ù–∞—á–∞–ª–æ</span><span id="statStart" style="font-size:14px;font-weight:600;color:var(--white);">‚Äî</span></div>
        <div style="display:flex;justify-content:space-between;"><span style="font-size:14px;color:var(--muted);">–ß–∞—â–µ –≤—Å–µ–≥–æ</span><span id="statTop" style="font-size:14px;font-weight:600;color:var(--accent);">‚Äî</span></div>
      </div>
    </div>
  </div>
</div>

<!-- TOOLS -->
<div id="toolsScreen" class="screen" style="padding-top:80px;">
  <nav><div class="logo"><div class="logo-icon">Y</div>Yrener</div><div class="nav-actions"><button class="nav-btn" onclick="showTab('menu')" style="width:auto;padding:0 14px;font-family:'Syne',sans-serif;font-size:14px;font-weight:700;">‚Üê –ù–∞–∑–∞–¥</button></div></nav>
  <div style="padding:60px 20px;text-align:center;"><div style="font-size:48px;margin-bottom:16px;">üéØ</div><h2 style="font-family:'Syne',sans-serif;font-size:24px;font-weight:800;color:var(--white);margin-bottom:8px;">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h2><p style="color:var(--muted);">–°–∫–æ—Ä–æ –ø–æ—è–≤—è—Ç—Å—è...</p></div>
</div>

<!-- PROTECT -->
<div id="protectScreen" class="screen" style="padding-top:80px;">
  <nav><div class="logo"><div class="logo-icon">Y</div>Yrener</div><div class="nav-actions"><button class="nav-btn" onclick="showTab('menu')" style="width:auto;padding:0 14px;font-family:'Syne',sans-serif;font-size:14px;font-weight:700;">‚Üê –ù–∞–∑–∞–¥</button></div></nav>
  <div style="padding:60px 20px;text-align:center;"><div style="font-size:48px;margin-bottom:16px;">üõ°Ô∏è</div><h2 style="font-family:'Syne',sans-serif;font-size:24px;font-weight:800;color:var(--white);margin-bottom:8px;">–ó–∞—â–∏—Ç–∞</h2><p style="color:var(--muted);">–°–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è...</p></div>
</div>

<!-- MODAL: CHANGE PASSWORD -->
<div id="changePwdModal" class="modal-overlay" onclick="if(event.target===this)closeModal('changePwdModal')">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-header"><span class="modal-title">üîë –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è</span><button class="modal-close" onclick="closeModal('changePwdModal')">‚úï</button></div>
    <div class="input-group"><label>–°—Ç–∞—Ä—ã–π –ø–∞—Ä–æ–ª—å</label><div style="position:relative;"><input type="password" id="oldPwd" placeholder="–í–≤–µ–¥–∏ —Å—Ç–∞—Ä—ã–π –ø–∞—Ä–æ–ª—å" style="padding-right:48px;" oninput="clrErr('errOldPwd',this)"><button type="button" onclick="tglPwd('oldPwd',this)" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--muted);font-size:18px;">üëÅ</button></div><div class="field-error" id="errOldPwd"></div></div>
    <div class="input-group"><label>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label><div style="position:relative;"><input type="password" id="newPwd" placeholder="–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤" style="padding-right:48px;" oninput="livePwd(this,'errNewPwd','pwdStr2')"><button type="button" onclick="tglPwd('newPwd',this)" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--muted);font-size:18px;">üëÅ</button></div><div class="field-error" id="errNewPwd"></div><div class="pwd-strength" id="pwdStr2"></div></div>
    <div class="input-group" style="margin-bottom:24px;"><label>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label><div style="position:relative;"><input type="password" id="confirmPwd" placeholder="–ü–æ–≤—Ç–æ—Ä–∏ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" style="padding-right:48px;" oninput="liveConf('confirmPwd','newPwd','errConfPwd')"><button type="button" onclick="tglPwd('confirmPwd',this)" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--muted);font-size:18px;">üëÅ</button></div><div class="field-error" id="errConfPwd"></div></div>
    <button class="btn btn-primary" onclick="doChangePwd()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</button>
  </div>
</div>

<!-- MODAL: FORGOT PASSWORD -->
<div id="forgotModal" class="modal-overlay" onclick="if(event.target===this)closeModal('forgotModal')">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-header"><span class="modal-title">üîì –ó–∞–±—ã–ª –ø–∞—Ä–æ–ª—å</span><button class="modal-close" onclick="closeModal('forgotModal')">‚úï</button></div>

    <!-- –®–ê–ì 1: –í–≤–æ–¥ email -->
    <div id="fStep1">
      <p style="color:var(--muted);font-size:13px;margin-bottom:18px;line-height:1.6;">–í–≤–µ–¥–∏ email –æ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞ ‚Äî –æ—Ç–ø—Ä–∞–≤–∏–º –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</p>
      <div class="input-group" style="margin-bottom:20px;">
        <label>Email –∞–∫–∫–∞—É–Ω—Ç–∞</label>
        <input type="email" id="forgotEmail" placeholder="your@example.com" oninput="liveEmail(this,'errForgotEmail')">
        <div class="field-error" id="errForgotEmail"></div>
      </div>
      <button id="fSendBtn" class="btn btn-primary" onclick="doForgotStep1()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥</button>
    </div>

    <!-- –®–ê–ì 2: –í–≤–æ–¥ –∫–æ–¥–∞ -->
    <div id="fStep2" style="display:none;">
      <!-- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
      <div style="background:rgba(42,171,238,0.08);border:1px solid rgba(42,171,238,0.2);border-radius:16px;padding:16px;margin-bottom:20px;">
        <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
          <div style="width:32px;height:32px;background:#2AABEE;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0;">‚úà</div>
          <div>
            <div style="font-size:13px;font-weight:600;color:var(--white);">–ü–∏—Å—å–º–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!</div>
            <div style="font-size:11px;color:var(--muted);">–Ω–∞: <span id="fEmailShow" style="color:var(--text);"></span></div>
          </div>
        </div>
        <div style="font-size:12px;color:var(--muted);line-height:1.5;">–ü—Ä–æ–≤–µ—Ä—å –ø–æ—á—Ç—É –∏ –≤–≤–µ–¥–∏ 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥. –ù–µ –∑–∞–±—É–¥—å –ø–∞–ø–∫—É <b style="color:var(--text);">–°–ø–∞–º</b>!</div>
        <div style="margin-top:10px;display:flex;justify-content:space-between;align-items:center;">
          <div style="font-size:11px;color:var(--muted);">‚è± –î–µ–π—Å—Ç–≤—É–µ—Ç: <span id="fTimer" style="font-weight:600;">5:00</span></div>
          <button onclick="doResendCode()" style="background:none;border:none;color:var(--accent);font-size:12px;cursor:pointer;font-family:'Inter',sans-serif;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–Ω–æ–≤–∞</button>
        </div>
      </div>

      <div class="input-group" style="margin-bottom:20px;">
        <label>–ö–æ–¥ –∏–∑ –ø–∏—Å—å–º–∞ (6 —Ü–∏—Ñ—Ä)</label>
        <input type="text" id="forgotCode" placeholder="_ _ _ _ _ _" maxlength="6" autocomplete="off"
          style="font-family:'Syne',sans-serif;font-size:24px;font-weight:800;letter-spacing:6px;text-align:center;"
          oninput="this.value=this.value.replace(/\D/g,'');clrErr('errForgotCode',this)">
        <div class="field-error" id="errForgotCode"></div>
      </div>
      <button class="btn btn-primary" onclick="doForgotStep2()" style="margin-bottom:10px;">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∫–æ–¥</button>
      <button class="btn btn-ghost" onclick="fGoStep(1)">‚Üê –ù–∞–∑–∞–¥</button>
    </div>

    <!-- –®–ê–ì 3: –ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å -->
    <div id="fStep3" style="display:none;">
      <div style="background:rgba(50,200,100,0.08);border:1px solid rgba(50,200,100,0.25);border-radius:16px;padding:14px;margin-bottom:18px;display:flex;align-items:center;gap:10px;">
        <span style="font-size:20px;">‚úÖ</span>
        <div><div style="font-size:14px;font-weight:600;color:#fff;">–ö–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω!</div><div style="font-size:12px;color:var(--muted);">–¢–µ–ø–µ—Ä—å –≤–≤–µ–¥–∏ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</div></div>
      </div>
      <div class="input-group">
        <label>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
        <div style="position:relative;">
          <input type="password" id="forgotNewPwd" placeholder="–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤" style="padding-right:48px;" oninput="livePwd(this,'errForgotPwd','pwdStr3')">
          <button type="button" onclick="tglPwd('forgotNewPwd',this)" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--muted);font-size:18px;">üëÅ</button>
        </div>
        <div class="field-error" id="errForgotPwd"></div>
        <div class="pwd-strength" id="pwdStr3"></div>
      </div>
      <div class="input-group" style="margin-bottom:24px;">
        <label>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–∞—Ä–æ–ª—å</label>
        <div style="position:relative;">
          <input type="password" id="forgotConfirm" placeholder="–ü–æ–≤—Ç–æ—Ä–∏ –ø–∞—Ä–æ–ª—å" style="padding-right:48px;" oninput="liveConf('forgotConfirm','forgotNewPwd','errForgotConf')">
          <button type="button" onclick="tglPwd('forgotConfirm',this)" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--muted);font-size:18px;">üëÅ</button>
        </div>
        <div class="field-error" id="errForgotConf"></div>
      </div>
      <button class="btn btn-primary" onclick="doForgotReset()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</button>
    </div>
  </div>
</div>

<!-- MODAL: GUEST -->
<div id="guestModal" class="modal-overlay center" onclick="if(event.target===this)closeModal('guestModal')">
  <div class="modal-center">
    <div style="font-size:52px;margin-bottom:16px;">üö´</div>
    <h3 style="font-family:'Syne',sans-serif;font-size:20px;font-weight:800;color:#fff;margin-bottom:10px;">–í—ã –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã</h3>
    <p style="color:var(--muted);font-size:14px;line-height:1.6;margin-bottom:24px;">–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.</p>
    <button class="btn btn-primary" onclick="closeModal('guestModal');logout();showAuth('register');" style="margin-bottom:10px;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
    <button class="btn btn-ghost" onclick="closeModal('guestModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê STATE ‚ïê‚ïê‚ïê
let CU = null; // currentUser
const T0 = new Date();
const VH = []; // visit history
const VC = {}; // visit counts
const SN = {menuScreen:'–ì–ª–∞–≤–Ω–∞—è',downloadScreen:'–°–∫–∞—á–∞—Ç—å',toolsScreen:'–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã',protectScreen:'–ó–∞—â–∏—Ç–∞',statsScreen:'–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',supportScreen:'–ü–æ–¥–¥–µ—Ä–∂–∫–∞',profileScreen:'–ü—Ä–æ—Ñ–∏–ª—å'};

// ‚ïê‚ïê‚ïê STORAGE ‚ïê‚ïê‚ïê
const GA = () => { try{ return JSON.parse(localStorage.getItem('yr_acc')||'{}'); }catch{ return {}; } };
const SA = (a) => localStorage.setItem('yr_acc', JSON.stringify(a));
const GS = () => { try{ return JSON.parse(localStorage.getItem('yr_ses')||'null'); }catch{ return null; } };
const SS = (u) => localStorage.setItem('yr_ses', JSON.stringify(u));
const CS = () => localStorage.removeItem('yr_ses');
const HP = (s) => { let h=0; for(let i=0;i<s.length;i++) h=(Math.imul(31,h)+s.charCodeAt(i))|0; return h.toString(36); };

// ‚ïê‚ïê‚ïê SCREENS ‚ïê‚ïê‚ïê
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  window.scrollTo(0,0);
  const n = SN[id];
  if(n){ VH.unshift({name:n,time:new Date()}); if(VH.length>20)VH.pop(); VC[n]=(VC[n]||0)+1; }
  if(id==='statsScreen') refreshStats();
}

function showAuth(mode) {
  showScreen('authScreen');
  const r = mode==='register';
  document.getElementById('registerFields').style.display = r?'block':'none';
  document.getElementById('loginFields').style.display   = r?'none':'block';
  document.getElementById('authSubtitle').textContent = r?'–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç':'–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç';
}

function showTab(tab) {
  const isMenu = tab==='menu';
  showScreen(isMenu?'menuScreen':'profileScreen');
  document.querySelectorAll('.nav-tab').forEach(t=>t.classList.remove('active'));
  if(isMenu){ document.getElementById('tabM1').classList.add('active'); document.getElementById('tabM2').classList.add('active'); }
  else { document.getElementById('tabP1').classList.add('active'); document.getElementById('tabP2').classList.add('active'); }
}

// ‚ïê‚ïê‚ïê MODALS ‚ïê‚ïê‚ïê
function openModal(id){ document.getElementById(id).style.display='flex'; }
function closeModal(id){
  document.getElementById(id).style.display='none';
  if(id==='forgotModal'){ clearInterval(_fTimerInterval); _fCode=null; fGoStep(1); }
}

// ‚ïê‚ïê‚ïê TOAST ‚ïê‚ïê‚ïê
function showToast(msg) {
  let t = document.getElementById('_toast');
  if(!t){ t=document.createElement('div'); t.id='_toast'; t.style.cssText='position:fixed;bottom:110px;left:50%;transform:translateX(-50%) translateY(20px);background:#1a1a1a;border:1px solid rgba(255,255,255,0.1);color:#f0f0f0;padding:12px 20px;border-radius:14px;font-size:14px;z-index:9999;opacity:0;transition:all 0.3s;white-space:nowrap;box-shadow:0 8px 24px rgba(0,0,0,0.5);pointer-events:none;'; document.body.appendChild(t); }
  t.textContent=msg; t.style.opacity='1'; t.style.transform='translateX(-50%) translateY(0)';
  clearTimeout(t._t); t._t=setTimeout(()=>{ t.style.opacity='0'; t.style.transform='translateX(-50%) translateY(10px)'; },3000);
}

// ‚ïê‚ïê‚ïê VALIDATION ‚ïê‚ïê‚ïê
const BW = ['fuck','shit','bitch','dick','cunt','nigger','—Ö—É–π','–ø–∏–∑–¥–∞','–±–ª—è–¥—å','–±–ª—è—Ç—å','–µ–±–∞—Ç—å','—Å—É–∫–∞','–ø–∏–∑–¥–µ—Ü','–º–∞–Ω–¥–∞','–∑–∞–ª—É–ø–∞','–ø–∏–¥–æ—Ä','–º—É–¥–∞–∫','–Ω–∞—Ö—É–π','–ø–æ—Ö—É–π','–Ω–∏—Ö—É—è','–∫—É—Ä–≤–∞','—à–ª—é—Ö–∞'];
const hasBW = s => BW.some(w=>s.toLowerCase().includes(w));

function setErr(id,msg){ const e=document.getElementById(id); if(!e)return; e.textContent=msg; msg?e.classList.add('show'):e.classList.remove('show'); }
function setSt(inp,st){ if(!inp)return; inp.classList.remove('valid','invalid'); if(st)inp.classList.add(st); }
function clrErr(id,inp){ setErr(id,''); setSt(inp,''); }

function liveUser(inp) {
  const v=inp.value.trim();
  if(!v){ setSt(inp,''); setErr('errUsername',''); return; }
  if(!/^[a-zA-Z–∞-—è—ë–ê-–Ø–Å0-9]+$/.test(v)){ setSt(inp,'invalid'); setErr('errUsername','‚ö†Ô∏è –¢–æ–ª—å–∫–æ –±—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã, –±–µ–∑ —Å–∏–º–≤–æ–ª–æ–≤'); return; }
  if(v.length<3){ setSt(inp,'invalid'); setErr('errUsername','‚ö†Ô∏è –ú–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞'); return; }
  if(hasBW(v)){ setSt(inp,'invalid'); setErr('errUsername','üö´ –ù–µ–¥–æ–ø—É—Å—Ç–∏–º–æ–µ —Å–ª–æ–≤–æ'); return; }
  setSt(inp,'valid'); setErr('errUsername','');
}

function liveEmail(inp,errId) {
  const v=inp.value.trim();
  if(!v){ setSt(inp,''); setErr(errId,''); return; }
  const ok=/^[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,}$/.test(v);
  if(!ok){ setSt(inp,'invalid'); setErr(errId,'‚ö†Ô∏è –ù–µ–≤–µ—Ä–Ω—ã–π email ‚Äî –ø—Ä–∏–º–µ—Ä: your@example.com'); return; }
  setSt(inp,'valid'); setErr(errId,'');
}

function livePwd(inp,errId,strId) {
  const v=inp.value;
  const ps=document.getElementById(strId);
  if(ps&&!ps.children.length) ps.innerHTML='<div class="pwd-bar"></div>'.repeat(4);
  const bars=ps?ps.querySelectorAll('.pwd-bar'):[];
  if(!v){ setSt(inp,''); setErr(errId,''); bars.forEach(b=>b.style.background='var(--border)'); return; }
  let s=0; if(v.length>=8)s++; if(v.length>=12)s++; if(/[A-Z–ê-–Ø–Å]/.test(v))s++; if(/[0-9]/.test(v))s++; if(/[^a-zA-Z–∞-—è—ë–ê-–Ø–Å0-9]/.test(v))s++;
  const c=['#e63e3e','#ff8c00','#f0d000','#32c864'][Math.min(Math.max(Math.floor(s/1.4),0),3)];
  const f=Math.min(Math.ceil(s/1.25),4);
  bars.forEach((b,i)=>b.style.background=i<f?c:'var(--border)');
  if(v.length<8){ setSt(inp,'invalid'); setErr(errId,'‚ö†Ô∏è –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤'); return; }
  setSt(inp,'valid'); setErr(errId,'');
}

function liveConf(confId,srcId,errId) {
  const cp=document.getElementById(confId), np=document.getElementById(srcId).value;
  if(!cp.value){ setSt(cp,''); setErr(errId,''); return; }
  if(cp.value!==np){ setSt(cp,'invalid'); setErr(errId,'‚ö†Ô∏è –ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç'); }
  else{ setSt(cp,'valid'); setErr(errId,''); }
}

function tglPwd(id,btn) {
  const inp=document.getElementById(id);
  if(inp.type==='password'){ inp.type='text'; btn.textContent='üôà'; }
  else{ inp.type='password'; btn.textContent='üëÅ'; }
}

// ‚ïê‚ïê‚ïê REGISTER ‚ïê‚ïê‚ïê
function doRegister() {
  const uI=document.getElementById('regUsername'), eI=document.getElementById('regEmail'), pI=document.getElementById('regPassword');
  // trigger live validators
  liveUser(uI); liveEmail(eI,'errEmail');
  if(!uI.value.trim()){ setSt(uI,'invalid'); setErr('errUsername','üî¥ –í–≤–µ–¥–∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è'); }
  if(!eI.value.trim()){ setSt(eI,'invalid'); setErr('errEmail','üî¥ –í–≤–µ–¥–∏ email, –Ω–∞–ø—Ä–∏–º–µ—Ä: your@example.com'); }
  if(!pI.value){ setSt(pI,'invalid'); setErr('errRegPwd','üî¥ –í–≤–µ–¥–∏ –ø–∞—Ä–æ–ª—å ‚Äî –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤'); }
  else livePwd(pI,'errRegPwd','pwdStr1');
  if(uI.classList.contains('invalid')||eI.classList.contains('invalid')||pI.classList.contains('invalid')) return;
  if(!uI.value.trim()||!eI.value.trim()||!pI.value) return;

  const acc=GA(), email=eI.value.trim().toLowerCase();
  if(acc[email]){ setSt(eI,'invalid'); setErr('errEmail','üî¥ Email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω ‚Äî –≤–æ–π–¥–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç'); return; }

  const user={name:uI.value.trim(), email, tag:'@'+uI.value.trim().toLowerCase(), pwdHash:HP(pI.value), createdAt:new Date().toLocaleDateString('ru-RU')};
  acc[email]=user; SA(acc); SS(user); CU=user;
  showToast('‚úÖ –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, '+user.name);
  enterApp();
}

// ‚ïê‚ïê‚ïê LOGIN ‚ïê‚ïê‚ïê
function doLogin() {
  const eI=document.getElementById('loginEmail'), pI=document.getElementById('loginPass');
  liveEmail(eI,'errLoginEmail');
  if(!eI.value.trim()){ setSt(eI,'invalid'); setErr('errLoginEmail','üî¥ –í–≤–µ–¥–∏ email'); }
  if(!pI.value){ setSt(pI,'invalid'); setErr('errLoginPass','üî¥ –í–≤–µ–¥–∏ –ø–∞—Ä–æ–ª—å'); }
  else{ setSt(pI,'valid'); setErr('errLoginPass',''); }
  if(eI.classList.contains('invalid')||!pI.value) return;

  const acc=GA(), email=eI.value.trim().toLowerCase(), a=acc[email];
  if(!a){ setSt(eI,'invalid'); setErr('errLoginEmail','üî¥ –ê–∫–∫–∞—É–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî —Å–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è'); return; }
  if(a.pwdHash!==HP(pI.value)){ setSt(pI,'invalid'); setErr('errLoginPass','üî¥ –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å ‚Äî –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑'); return; }

  SS(a); CU=a;
  showToast('üëã –ü—Ä–∏–≤–µ—Ç —Å–Ω–æ–≤–∞, '+a.name+'!');
  enterApp();
}

// ‚ïê‚ïê‚ïê GUEST ‚ïê‚ïê‚ïê
function guestEnter(){ CU={name:'–ì–æ—Å—Ç—å',tag:'@guest',email:'‚Äî',createdAt:'‚Äî',isGuest:true}; enterApp(); }

// ‚ïê‚ïê‚ïê ENTER APP ‚ïê‚ïê‚ïê
function enterApp() {
  document.getElementById('greetingText').textContent = '–ü—Ä–∏–≤–µ—Ç, '+CU.name+' üëã';
  document.getElementById('profileName').textContent = CU.name;
  document.getElementById('profileTag').textContent = CU.tag;
  document.getElementById('avatarLetter').textContent = CU.name[0].toUpperCase();
  document.getElementById('profileEmail').textContent = CU.email||'‚Äî';
  document.getElementById('profileDate').textContent = CU.createdAt||'‚Äî';
  showScreen('menuScreen');
  document.querySelectorAll('.nav-tab').forEach(t=>t.classList.remove('active'));
  document.getElementById('tabM1').classList.add('active');
  document.getElementById('tabM2').classList.add('active');
}

// ‚ïê‚ïê‚ïê LOGOUT ‚ïê‚ïê‚ïê
function logout(){ CU=null; CS(); showToast('üëã –¢—ã –≤—ã—à–µ–ª –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞'); setTimeout(()=>showScreen('landingScreen'),400); }

// ‚ïê‚ïê‚ïê CHANGE PASSWORD ‚ïê‚ïê‚ïê
function openChangePwd() {
  if(!CU||CU.isGuest){ openModal('guestModal'); return; }
  if(CU.googleAuth){ showToast('‚ÑπÔ∏è –£ Google –∞–∫–∫–∞—É–Ω—Ç–∞ –Ω–µ—Ç –ø–∞—Ä–æ–ª—è'); return; }
  ['oldPwd','newPwd','confirmPwd'].forEach(id=>{ const e=document.getElementById(id); if(e){e.value='';setSt(e,'');e.type='password';} });
  ['errOldPwd','errNewPwd','errConfPwd'].forEach(id=>setErr(id,''));
  const ps2=document.getElementById('pwdStr2'); if(ps2)ps2.innerHTML='';
  openModal('changePwdModal');
}

function doChangePwd() {
  const oI=document.getElementById('oldPwd'), nI=document.getElementById('newPwd'), cI=document.getElementById('confirmPwd');
  let ok=true;
  if(!oI.value){ setSt(oI,'invalid'); setErr('errOldPwd','üî¥ –í–≤–µ–¥–∏ —Å—Ç–∞—Ä—ã–π –ø–∞—Ä–æ–ª—å'); ok=false; }
  if(!nI.value){ setSt(nI,'invalid'); setErr('errNewPwd','üî¥ –í–≤–µ–¥–∏ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å'); ok=false; }
  else{ livePwd(nI,'errNewPwd','pwdStr2'); if(nI.classList.contains('invalid'))ok=false; }
  if(!cI.value){ setSt(cI,'invalid'); setErr('errConfPwd','üî¥ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å'); ok=false; }
  else if(cI.value!==nI.value){ setSt(cI,'invalid'); setErr('errConfPwd','‚ö†Ô∏è –ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç'); ok=false; }
  if(!ok)return;

  const acc=GA(), a=acc[CU.email];
  if(!a||a.pwdHash!==HP(oI.value)){ setSt(oI,'invalid'); setErr('errOldPwd','üî¥ –ù–µ–≤–µ—Ä–Ω—ã–π —Å—Ç–∞—Ä—ã–π –ø–∞—Ä–æ–ª—å'); return; }
  if(oI.value===nI.value){ setSt(nI,'invalid'); setErr('errNewPwd','‚ö†Ô∏è –ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å–æ —Å—Ç–∞—Ä—ã–º'); return; }
  a.pwdHash=HP(nI.value); acc[CU.email]=a; SA(acc); SS(a); CU=a;
  closeModal('changePwdModal');
  showToast('‚úÖ –ü–∞—Ä–æ–ª—å —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω—ë–Ω!');
}

// ‚ïê‚ïê‚ïê FIREBASE + GOOGLE AUTH ‚ïê‚ïê‚ïê
const firebaseConfig = {
  apiKey: "AIzaSyBvySxAGJKwa3fxQs74mNoPoCijQwRc5co",
  authDomain: "yrenercc-9f057.firebaseapp.com",
  projectId: "yrenercc-9f057",
  storageBucket: "yrenercc-9f057.firebasestorage.app",
  messagingSenderId: "125306856373",
  appId: "1:125306856373:web:317365a526e5be833c6ffc"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const googleProvider = new firebase.auth.GoogleAuthProvider();

function signInWithGoogle() {
  auth.signInWithPopup(googleProvider).then(result => {
    const u = result.user;
    const email = u.email.toLowerCase();
    const accounts = GA();

    // –ï—Å–ª–∏ –∞–∫–∫–∞—É–Ω—Ç —É–∂–µ –µ—Å—Ç—å ‚Äî –ø—Ä–æ—Å—Ç–æ –≤—Ö–æ–¥–∏–º
    if (!accounts[email]) {
      // –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç —á–µ—Ä–µ–∑ Google
      const name = u.displayName ? u.displayName.split(' ')[0] : email.split('@')[0];
      accounts[email] = {
        name: name,
        email: email,
        tag: '@' + name.toLowerCase().replace(/[^a-z–∞-—è—ë0-9]/gi,''),
        pwdHash: null, // –Ω–µ—Ç –ø–∞—Ä–æ–ª—è ‚Äî —Ç–æ–ª—å–∫–æ Google
        createdAt: new Date().toLocaleDateString('ru-RU'),
        googleAuth: true,
        avatar: u.photoURL || null
      };
      SA(accounts);
    }

    CU = accounts[email];
    SS(CU);
    showToast('‚úÖ –í–æ—à—ë–ª —á–µ—Ä–µ–∑ Google: ' + CU.name);
    enterApp();

  }).catch(err => {
    console.error('Google auth error:', err);
    if (err.code === 'auth/popup-closed-by-user') return;
    if (err.code === 'auth/unauthorized-domain') {
      showToast('‚ùå –î–æ–º–µ–Ω –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –≤ Firebase ‚Äî –¥–æ–±–∞–≤—å –≤ Authorized domains');
    } else {
      showToast('‚ùå –û—à–∏–±–∫–∞ Google –≤—Ö–æ–¥–∞: ' + err.message);
    }
  });
}

// ‚ïê‚ïê‚ïê EMAILJS ‚ïê‚ïê‚ïê
const EJS_SERVICE  = 'YrenerCC';
const EJS_TEMPLATE = 'template_rty20ys';
const EJS_KEY      = 'hVttfvNjwdQPi7OH7';
emailjs.init(EJS_KEY);

// ‚ïê‚ïê‚ïê FORGOT PASSWORD (3 —à–∞–≥–∞) ‚ïê‚ïê‚ïê
let _fCode = null;
let _fEmail = null;
let _fTimerInterval = null;

function fGoStep(n) {
  [1,2,3].forEach(i => document.getElementById('fStep'+i).style.display = i===n?'block':'none');
}

function doForgotStep1() {
  const eI = document.getElementById('forgotEmail');
  liveEmail(eI,'errForgotEmail');
  if(!eI.value.trim()){ setSt(eI,'invalid'); setErr('errForgotEmail','üî¥ –í–≤–µ–¥–∏ email'); return; }
  if(eI.classList.contains('invalid')) return;

  const acc = GA(), email = eI.value.trim().toLowerCase();
  if(!acc[email]){ setSt(eI,'invalid'); setErr('errForgotEmail','üî¥ –ê–∫–∫–∞—É–Ω—Ç —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω'); return; }

  // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥
  _fCode = String(Math.floor(100000 + Math.random() * 900000));
  _fEmail = email;

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏
  const btn = document.getElementById('fSendBtn');
  btn.textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º...';
  btn.disabled = true;

  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ EmailJS
  emailjs.send(EJS_SERVICE, EJS_TEMPLATE, {
    to_email: email,
    code: _fCode
  }).then(() => {
    btn.textContent = '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥';
    btn.disabled = false;

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏
    document.getElementById('fEmailShow').textContent = email;

    // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä 5 –º–∏–Ω—É—Ç
    clearInterval(_fTimerInterval);
    let secs = 300;
    const timerEl = document.getElementById('fTimer');
    timerEl.textContent = '5:00';
    timerEl.style.color = 'var(--muted)';
    _fTimerInterval = setInterval(() => {
      secs--;
      const m = Math.floor(secs/60), s = secs%60;
      timerEl.textContent = m+':'+(s<10?'0':'')+s;
      if(secs <= 60) timerEl.style.color = '#ff8c00';
      if(secs <= 0) {
        clearInterval(_fTimerInterval);
        timerEl.textContent = '–ò—Å—Ç—ë–∫';
        timerEl.style.color = 'var(--accent)';
        _fCode = null;
      }
    }, 1000);

    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–ª–µ –∫–æ–¥–∞
    const cI = document.getElementById('forgotCode');
    cI.value = ''; setSt(cI,''); setErr('errForgotCode','');

    fGoStep(2);

  }).catch((err) => {
    btn.textContent = '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥';
    btn.disabled = false;
    console.error('EmailJS error:', err);
    setErr('errForgotEmail','‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∏—Å—å–º–æ ‚Äî –ø–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞');
  });
}

function doResendCode() {
  if(!_fEmail) return;
  _fCode = String(Math.floor(100000 + Math.random() * 900000));
  showToast('‚è≥ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –∫–æ–¥...');
  emailjs.send(EJS_SERVICE, EJS_TEMPLATE, {
    to_email: _fEmail,
    code: _fCode
  }).then(() => {
    showToast('‚úÖ –ù–æ–≤—ã–π –∫–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!');
    clearInterval(_fTimerInterval);
    let secs = 300;
    const timerEl = document.getElementById('fTimer');
    timerEl.textContent = '5:00'; timerEl.style.color = 'var(--muted)';
    _fTimerInterval = setInterval(() => {
      secs--;
      const m=Math.floor(secs/60), s=secs%60;
      timerEl.textContent = m+':'+(s<10?'0':'')+s;
      if(secs<=60) timerEl.style.color='#ff8c00';
      if(secs<=0){ clearInterval(_fTimerInterval); timerEl.textContent='–ò—Å—Ç—ë–∫'; timerEl.style.color='var(--accent)'; _fCode=null; }
    },1000);
    const cI=document.getElementById('forgotCode'); cI.value=''; setSt(cI,''); setErr('errForgotCode','');
  }).catch(()=>{ showToast('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å ‚Äî –ø–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞'); });
}

function doForgotStep2() {
  const cI = document.getElementById('forgotCode');
  const entered = cI.value.trim();

  if(!entered){ setSt(cI,'invalid'); setErr('errForgotCode','üî¥ –í–≤–µ–¥–∏ –∫–æ–¥ –∏–∑ –ø–∏—Å—å–º–∞'); return; }
  if(entered.length !== 6){ setSt(cI,'invalid'); setErr('errForgotCode','‚ö†Ô∏è –ö–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 6 —Ü–∏—Ñ—Ä'); return; }

  if(!_fCode) {
    setSt(cI,'invalid');
    setErr('errForgotCode','‚è± –ö–æ–¥ –∏—Å—Ç—ë–∫ ‚Äî –Ω–∞–∂–º–∏ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–Ω–æ–≤–∞"');
    return;
  }

  if(entered !== _fCode) {
    setSt(cI,'invalid');
    setErr('errForgotCode','üî¥ –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ ‚Äî –ø—Ä–æ–≤–µ—Ä—å –∏ –ø–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞');
    cI.style.animation='shake 0.4s ease';
    setTimeout(()=>cI.style.animation='',400);
    return;
  }

  // –ö–æ–¥ –≤–µ—Ä–Ω—ã–π!
  clearInterval(_fTimerInterval);
  setSt(cI,'valid'); setErr('errForgotCode','');
  ['forgotNewPwd','forgotConfirm'].forEach(id=>{ const e=document.getElementById(id); if(e){e.value='';setSt(e,'');} });
  const ps3=document.getElementById('pwdStr3'); if(ps3) ps3.innerHTML='';
  setErr('errForgotPwd',''); setErr('errForgotConf','');
  fGoStep(3);
}

function doForgotReset() {
  const nI=document.getElementById('forgotNewPwd'), cI=document.getElementById('forgotConfirm');
  let ok=true;
  if(!nI.value){ setSt(nI,'invalid'); setErr('errForgotPwd','üî¥ –í–≤–µ–¥–∏ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å'); ok=false; }
  else{ livePwd(nI,'errForgotPwd','pwdStr3'); if(nI.classList.contains('invalid'))ok=false; }
  if(!cI.value){ setSt(cI,'invalid'); setErr('errForgotConf','üî¥ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏ –ø–∞—Ä–æ–ª—å'); ok=false; }
  else if(cI.value!==nI.value){ setSt(cI,'invalid'); setErr('errForgotConf','‚ö†Ô∏è –ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç'); ok=false; }
  if(!ok) return;

  const acc=GA();
  acc[_fEmail].pwdHash = HP(nI.value);
  SA(acc);
  _fCode=null; _fEmail=null;
  closeModal('forgotModal');
  fGoStep(1);
  showToast('‚úÖ –ü–∞—Ä–æ–ª—å —Å–±—Ä–æ—à–µ–Ω! –í–æ–π–¥–∏ —Å –Ω–æ–≤—ã–º –ø–∞—Ä–æ–ª–µ–º');
}

// ‚ïê‚ïê‚ïê STATS ‚ïê‚ïê‚ïê
setInterval(()=>{ const e=document.getElementById('statTime'); if(!e)return; const s=Math.floor((new Date()-T0)/1000); e.textContent=s<60?s+'—Å':s<3600?Math.floor(s/60)+'–º '+(s%60)+'—Å':Math.floor(s/3600)+'—á '+Math.floor((s%3600)/60)+'–º'; },1000);

function refreshStats() {
  document.getElementById('statSections').textContent=Object.keys(VC).length;
  document.getElementById('statUser').textContent=CU?CU.name:'‚Äî';
  document.getElementById('statStart').textContent=T0.toLocaleTimeString('ru-RU',{hour:'2-digit',minute:'2-digit'});
  let top='‚Äî',max=0; for(const[k,v] of Object.entries(VC)) if(v>max){max=v;top=k;}
  document.getElementById('statTop').textContent=top;
  const h=document.getElementById('statHistory');
  if(!VH.length){ h.innerHTML='<div style="color:var(--muted);font-size:13px;">–ü–æ–∫–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö...</div>'; return; }
  h.innerHTML=VH.slice(0,8).map(x=>`<div style="display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(--border);"><span style="font-size:14px;color:var(--text);">${x.name}</span><span style="font-size:12px;color:var(--muted);">${x.time.toLocaleTimeString('ru-RU',{hour:'2-digit',minute:'2-digit',second:'2-digit'})}</span></div>`).join('');
}

// ‚ïê‚ïê‚ïê LANG ‚ïê‚ïê‚ïê
function setLang(btn,code) {
  document.querySelectorAll('.lang-btn').forEach(b=>b.classList.remove('active')); btn.classList.add('active');
  const L={ru:{g:'–ü—Ä–∏–≤–µ—Ç',h:'–ì–ª–∞–≤–Ω–∞—è',p:'–ü—Ä–æ—Ñ–∏–ª—å',l:'–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞'},en:{g:'Hello',h:'Home',p:'Profile',l:'Log out'},uz:{g:'Salom',h:'Bosh sahifa',p:'Profil',l:'Chiqish'},uk:{g:'–ü—Ä–∏–≤—ñ—Ç',h:'–ì–æ–ª–æ–≤–Ω–∞',p:'–ü—Ä–æ—Ñ—ñ–ª—å',l:'–í–∏–π—Ç–∏'},zh:{g:'‰Ω†Â•Ω',h:'‰∏ªÈ°µ',p:'‰∏™‰∫∫ËµÑÊñô',l:'ÈÄÄÂá∫Ë¥¶Âè∑'}};
  const d=L[code]||L.ru;
  if(CU) document.getElementById('greetingText').textContent=d.g+', '+CU.name+' üëã';
  const tl=document.querySelectorAll('.nav-tab-label');
  [tl[0],tl[2]].forEach(t=>{if(t)t.textContent=d.h;});
  [tl[1],tl[3]].forEach(t=>{if(t)t.textContent=d.p;});
  const lb=document.querySelector('.logout-btn'); if(lb)lb.textContent=d.l;
}

// ‚ïê‚ïê‚ïê AUTO LOGIN ‚ïê‚ïê‚ïê
window.addEventListener('DOMContentLoaded',()=>{ const s=GS(); if(s){CU=s;enterApp();} });
</script>
</body>
</html>
